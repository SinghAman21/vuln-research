{
  "role": "Senior Full Stack Developer & Security Researcher",
  "task": "Create a React-based application (preferably Next.js for full-stack capabilities or a React SPA with a Node backend) that replicates the functionality and intentional vulnerabilities of the provided Express/EJS application.",
  "requirements": [
    "Replicate the UI/UX using the provided EJS templates and CSS as a reference.",
    "Implement the 'Fake Data' mode exactly as it is in the current app to allow for easy testing without a database.",
    "Preserve the intentional vulnerabilities (SQL Injection, XSS, Weak Auth, IDOR, etc.) documented in README-VULNERABILITIES.md.",
    "For SQL Injection: If using a real DB connection in the new app, ensure queries are concatenated strings. If using Fake Data mode, you may simulate the vulnerability or note that it's only active in DB mode.",
    "For XSS: Ensure that user input is rendered dangerously (e.g., using dangerouslySetInnerHTML in React) where appropriate to replicate the vulnerability.",
    "The application must be runnable and functional."
  ],
  "context": "The source application is a deliberately vulnerable restaurant website used for educational purposes. The goal is to port this to a modern stack (React) while keeping the security flaws for training.",
  "source_code": {
    "server.js": "// DELIBERATELY VULNERABLE APPLICATION - FOR SECURITY TESTING ONLY\n// DO NOT DEPLOY IN PRODUCTION ENVIRONMENTS\n\nconst express = require('express');\nconst mysql = require('mysql2');\nconst session = require('express-session');\nconst bodyParser = require('body-parser');\nconst path = require('path');\nconst fakeData = require('./data/fakeData');\n\nconst app = express();\nconst PORT = 3000;\n\n// \ud83d\udd25 UI-ONLY MODE: Enables fake DB data, disables MySQL\nconst USE_FAKE_DB = true;   // \u2190 change to false when DB is ready\n\n// Middleware\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(bodyParser.json());\napp.use(express.static('public'));\napp.set('view engine', 'ejs');\n\n// VULNERABLE: Weak session configuration - no secure flags\napp.use(session({\n  secret: 'weak-secret-key',\n  resave: false,\n  saveUninitialized: true,\n  cookie: { \n    secure: false,\n    httpOnly: false,\n    sameSite: 'none'\n  }\n}));\n\n// Database connection - Configure for Aurora\nlet db;\nif (!USE_FAKE_DB) {\n  db = mysql.createConnection({\n    host: process.env.DB_HOST || 'localhost',\n    user: process.env.DB_USER || 'root',\n    password: process.env.DB_PASSWORD || 'password',\n    database: process.env.DB_NAME || 'restaurant_db'\n  });\n\n  db.connect((err) => {\n    if (err) {\n      console.error('Database connection failed:', err);\n      return;\n    }\n    console.log('Connected to Aurora/MySQL database');\n  });\n} else {\n  console.log(\"\u26a0\ufe0f  USING FAKE DATABASE \u2014 REAL DB DISABLED\");\n}\n\n// ------------------------------------------------------------\n// ROUTES\n// ------------------------------------------------------------\n\n// Home page\napp.get('/', (req, res) => {\n  res.render('index', { user: req.session.user });\n});\n\n// ------------------------------------------------------------\n// LOGIN (VULNERABLE)\n// ------------------------------------------------------------\napp.get('/login', (req, res) => {\n  res.render('login', { error: null\n    ,    user: req.session.user || null\n   });\n});\n\napp.post('/login', (req, res) => {\n  const { username, password } = req.body;\n\n  // Fake DB mode\n  if (USE_FAKE_DB) {\n    const user = fakeData.users.find(username, password);\n    if (user) {\n        req.session.user = { id: user.id, username: user.username, role: user.role };\n        return res.redirect('/menu');\n    } else {\n        return res.render('login', { error: 'Invalid credentials (try admin/admin123 or demo/password)' });\n    }\n  }\n\n  const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n  \n  console.log('Executing query:', query);\n  \n  db.query(query, (err, results) => {\n    if (err) {\n      return res.render('login', { error: 'Database error: ' + err.message });\n    }\n    \n    if (results.length > 0) {\n      req.session.user = {\n        id: results[0].id,\n        username: results[0].username,\n        role: results[0].role\n      };\n      res.redirect('/menu');\n    } else {\n      res.render('login', { error: 'Invalid credentials' });\n    }\n  });\n});\n\n// Logout\napp.get('/logout', (req, res) => {\n  req.session.destroy();\n  res.redirect('/');\n});\n\n// ------------------------------------------------------------\n// MENU ROUTES\n// ------------------------------------------------------------\n\n// View menu\napp.get('/menu', (req, res) => {\n  if (USE_FAKE_DB) {\n    return res.render('menu', {\n      user: req.session.user,\n      menu: fakeData.menu.getAll()\n    });\n  }\n\n  db.query('SELECT * FROM menu_items', (err, items) => {\n    if (err) throw err;\n    res.render('menu', { user: req.session.user, menu: items });\n  });\n});\n\n\n// Add menu item form\napp.get('/menu/add', (req, res) => {\n  if (!req.session.user || req.session.user.role !== 'manager') {\n      return res.redirect('/login');\n  }\n  res.render('add_menu', { user: req.session.user });\n});\n\n// Add menu item (POST)\napp.post('/menu/add', (req, res) => {\n  if (!req.session.user || req.session.user.role !== 'manager') {\n      return res.status(403).send('Unauthorized');\n  }\n\n  const { name, description, price } = req.body;\n\n  if (USE_FAKE_DB) {\n    fakeData.menu.add({ name, description, price });\n    return res.redirect('/menu');\n  }\n\n  const query = `INSERT INTO menu_items (name, description, price) VALUES ('${name}', '${description}', ${price})`;\n  \n  db.query(query, (err) => {\n    if (err) {\n      return res.send('Error: ' + err.message);\n    }\n    res.redirect('/menu');\n  });\n});\n\n// Edit menu item form\napp.get('/menu/edit/:id', (req, res) => {\n  if (!req.session.user || req.session.user.role !== 'manager') {\n      return res.redirect('/login');\n  }\n\n  const id = req.params.id;\n\n  if (USE_FAKE_DB) {\n    const item = fakeData.menu.getById(id);\n    if (item) {\n        return res.render('edit_menu', { user: req.session.user, item });\n    } else {\n        return res.send('Item not found');\n    }\n  }\n  \n  db.query(`SELECT * FROM menu_items WHERE id = ${id}`, (err, results) => {\n    if (err || results.length === 0) {\n      return res.send('Item not found');\n    }\n    res.render('edit_menu', { user: req.session.user, item: results[0] });\n  });\n});\n\n// Edit menu item (POST)\napp.post('/menu/edit/:id', (req, res) => {\n  if (!req.session.user || req.session.user.role !== 'manager') {\n      return res.status(403).send('Unauthorized');\n  }\n\n  const id = req.params.id;\n  const { name, description, price } = req.body;\n\n  if (USE_FAKE_DB) {\n    fakeData.menu.update(id, { name, description, price });\n    return res.redirect('/menu');\n  }\n  \n  const query = `UPDATE menu_items SET name='${name}', description='${description}', price=${price} WHERE id=${id}`;\n  \n  db.query(query, (err) => {\n    if (err) {\n      return res.send('Error: ' + err.message);\n    }\n    res.redirect('/menu');\n  });\n});\n\n// Delete menu item\napp.get('/menu/delete/:id', (req, res) => { // Changed to GET for simplicity in links, usually should be POST/DELETE\n    if (!req.session.user || req.session.user.role !== 'manager') {\n        return res.redirect('/login');\n    }\n  \n    const id = req.params.id;\n\n    if (USE_FAKE_DB) {\n      fakeData.menu.delete(id);\n      return res.redirect('/menu');\n    }\n    \n    db.query(`DELETE FROM menu_items WHERE id = ${id}`, (err) => {\n      if (err) throw err;\n      res.redirect('/menu');\n    });\n});\n\n// ------------------------------------------------------------\n// ORDERS ROUTES\n// ------------------------------------------------------------\n\n// View orders\napp.get('/orders', (req, res) => {\n  if (!req.session.user) return res.redirect('/login');\n\n  if (USE_FAKE_DB) {\n    let orders;\n    if (req.session.user.role === 'manager') {\n        orders = fakeData.orders.getAll();\n    } else {\n        orders = fakeData.orders.getByUser(req.session.user.id);\n    }\n    return res.render('orders', { user: req.session.user, orders });\n  }\n  \n  let query;\n  if (req.session.user.role === 'manager') {\n    query = `\n      SELECT o.*, u.username, m.name as item_name \n      FROM orders o \n      JOIN users u ON o.user_id = u.id \n      JOIN menu_items m ON o.item_id = m.id\n    `;\n  } else {\n    query = `\n      SELECT o.*, m.name as item_name \n      FROM orders o \n      JOIN menu_items m ON o.item_id = m.id \n      WHERE o.user_id = ${req.session.user.id}\n    `;\n  }\n\n  db.query(query, (err, orders) => {\n    if (err) throw err;\n    res.render('orders', { user: req.session.user, orders });\n  });\n});\n\n// Add order form\napp.get('/orders/add', (req, res) => {\n  if (!req.session.user) return res.redirect('/login');\n  \n  const selectedItemId = req.query.item_id;\n\n  if (USE_FAKE_DB) {\n    return res.render('add_order', {\n      user: req.session.user,\n      items: fakeData.menu.getAll(),\n      selectedItemId\n    });\n  }\n\n  db.query('SELECT * FROM menu_items', (err, items) => {\n    if (err) throw err;\n    res.render('add_order', { user: req.session.user, items, selectedItemId });\n  });\n});\n\n// Add order (POST)\napp.post('/orders/add', (req, res) => {\n  if (!req.session.user) return res.redirect('/login');\n\n  const { item_id, quantity } = req.body;\n  const user_id = req.session.user.id;\n\n  if (USE_FAKE_DB) {\n    fakeData.orders.add({ user_id, item_id: parseInt(item_id), quantity: parseInt(quantity) });\n    return res.redirect('/orders');\n  }\n  \n  const query = `INSERT INTO orders (user_id, item_id, quantity) VALUES (${user_id}, ${item_id}, ${quantity})`;\n  \n  db.query(query, (err) => {\n    if (err) {\n      return res.send('Error: ' + err.message);\n    }\n    res.redirect('/orders');\n  });\n});\n\n// ------------------------------------------------------------\n// SEARCH ROUTE\n// ------------------------------------------------------------\napp.get('/search', (req, res) => {\n  const searchTerm = req.query.q || '';\n\n  if (USE_FAKE_DB) {\n    return res.render('search_results', {\n      user: req.session.user,\n      searchTerm,\n      results: fakeData.menu.search(searchTerm)\n    });\n  }\n  \n  const query = `\n    SELECT * FROM menu_items \n    WHERE name LIKE '%${searchTerm}%' \n    OR description LIKE '%${searchTerm}%'\n  `;\n  \n  db.query(query, (err, results) => {\n    if (err) {\n      return res.send('Search error: ' + err.message);\n    }\n    res.render('search_results', { user: req.session.user, results, searchTerm });\n  });\n});\n\n// ------------------------------------------------------------\n// START SERVER\n// ------------------------------------------------------------\napp.listen(PORT, () => {\n  console.log(`\u26a0\ufe0f  VULNERABLE APPLICATION RUNNING ON PORT ${PORT}`);\n  console.log(`\u26a0\ufe0f  FOR SECURITY TESTING ONLY - DO NOT EXPOSE TO PUBLIC INTERNET`);\n  console.log(`\ud83d\udd25 Fake DB mode: ${USE_FAKE_DB}`);\n});\n",
    "data/fakeData.js": "\nconst users = [\n    { id: 1, username: \"admin\", password: \"admin123\", role: \"manager\" },\n    { id: 2, username: \"demo\", password: \"password\", role: \"customer\" }\n];\n\nconst menuItems = [\n    { id: 1, name: \"Truffle Risotto\", description: \"Creamy arborio rice with black truffle and parmesan\", price: 25.00 },\n    { id: 2, name: \"Lobster Bisque\", description: \"Rich and creamy soup with fresh lobster chunks\", price: 18.00 },\n    { id: 3, name: \"Beef Wellington\", description: \"Tender beef fillet wrapped in puff pastry with mushroom duxelles\", price: 35.00 },\n    { id: 4, name: \"Cr\u00e8me Br\u00fbl\u00e9e\", description: \"Classic French dessert with a caramelized sugar crust\", price: 12.00 },\n    { id: 5, name: \"Coq au Vin\", description: \"Chicken braised with wine, lardons, mushrooms, and garlic\", price: 22.00 }\n];\n\nconst orders = [\n    { id: 1, user_id: 2, item_id: 1, quantity: 2, created_at: new Date().toISOString() },\n    { id: 2, user_id: 2, item_id: 4, quantity: 1, created_at: new Date().toISOString() }\n];\n\n// Helper to simulate auto-increment ID\nconst getNextId = (collection) => {\n    return collection.length > 0 ? Math.max(...collection.map(i => i.id)) + 1 : 1;\n};\n\nmodule.exports = {\n    users: {\n        find: (username, password) => users.find(u => u.username === username && u.password === password),\n        findById: (id) => users.find(u => u.id === id)\n    },\n    menu: {\n        getAll: () => menuItems,\n        getById: (id) => menuItems.find(i => i.id === parseInt(id)),\n        search: (term) => menuItems.filter(i => \n            i.name.toLowerCase().includes(term.toLowerCase()) || \n            i.description.toLowerCase().includes(term.toLowerCase())\n        ),\n        add: (item) => {\n            const newItem = { id: getNextId(menuItems), ...item, price: parseFloat(item.price) };\n            menuItems.push(newItem);\n            return newItem;\n        },\n        update: (id, updates) => {\n            const index = menuItems.findIndex(i => i.id === parseInt(id));\n            if (index !== -1) {\n                menuItems[index] = { ...menuItems[index], ...updates, price: parseFloat(updates.price) };\n                return true;\n            }\n            return false;\n        },\n        delete: (id) => {\n            const index = menuItems.findIndex(i => i.id === parseInt(id));\n            if (index !== -1) {\n                menuItems.splice(index, 1);\n                return true;\n            }\n            return false;\n        }\n    },\n    orders: {\n        getAll: () => {\n            return orders.map(o => {\n                const item = menuItems.find(i => i.id === o.item_id);\n                const user = users.find(u => u.id === o.user_id);\n                return {\n                    ...o,\n                    item_name: item ? item.name : 'Unknown Item',\n                    username: user ? user.username : 'Unknown User'\n                };\n            });\n        },\n        getByUser: (userId) => {\n            return orders\n                .filter(o => o.user_id === userId)\n                .map(o => {\n                    const item = menuItems.find(i => i.id === o.item_id);\n                    return {\n                        ...o,\n                        item_name: item ? item.name : 'Unknown Item'\n                    };\n                });\n        },\n        add: (order) => {\n            const newOrder = { \n                id: getNextId(orders), \n                ...order, \n                created_at: new Date().toISOString() \n            };\n            orders.push(newOrder);\n            return newOrder;\n        },\n        delete: (id) => {\n            const index = orders.findIndex(o => o.id === parseInt(id));\n            if (index !== -1) {\n                orders.splice(index, 1);\n                return true;\n            }\n            return false;\n        }\n    }\n};\n",
    "views/login.ejs": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Login - La Belle Cuisine</title>\n  <link rel=\"stylesheet\" href=\"/style.css\">\n</head>\n<body>\n  <!-- Navigation -->\n  <nav class=\"navbar\" id=\"navbar\">\n    <div class=\"nav-brand\">\n      <a href=\"/\">La Belle Cuisine</a>\n    </div>\n    <div class=\"nav-toggle\" id=\"navToggle\">\n      <i class=\"fas fa-bars\"></i>\n    </div>\n    <ul class=\"nav-links\" id=\"navLinks\">\n      <li><a href=\"/\">Home</a></li>\n      <li><a href=\"#about\">About</a></li>\n      <li><a href=\"/menu\">Menu</a></li>\n      <li><a href=\"#reservations\">Reservations</a></li>\n      <li><a href=\"#contact\">Contact</a></li>\n      <% if (!user) { %>\n        <li><a href=\"/login\">Login</a></li>\n      <% } else { %>\n        <li><a href=\"/orders\">Orders</a></li>\n        <li><a href=\"/logout\">Logout (<%= user.username %>)</a></li>\n      <% } %>\n    </ul>\n  </nav>\n\n  <!-- Hero Section -->\n  <section class=\"hero\" style=\"height: 30vh; min-height: 200px; display:flex; align-items:center; justify-content:center;\">\n    <div class=\"hero-content\">\n      <h1>Login</h1>\n    </div>\n  </section>\n\n  <!-- Login Form Section -->\n  <section class=\"login-section\" style=\"padding:2rem 0;\">\n    <div class=\"container\" style=\"max-width:400px; margin:auto;\">\n      <% if (error) { %>\n        <p class=\"error\" style=\"color:red; text-align:center;\"><%= error %></p>\n      <% } %>\n      <form method=\"POST\" action=\"/login\" class=\"login-form\" style=\"display:flex; flex-direction:column; gap:1rem;\">\n        <div class=\"form-group\">\n          <label for=\"username\">Username</label>\n          <input type=\"text\" id=\"username\" name=\"username\" placeholder=\"Enter username\" required class=\"input-field\" />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"password\">Password</label>\n          <input type=\"password\" id=\"password\" name=\"password\" placeholder=\"Enter password\" required class=\"input-field\" />\n        </div>\n        <button type=\"submit\" class=\"btn-primary\" style=\"width:100%;\">Login</button>\n      </form>\n    </div>\n  </section>\n\n  <!-- Footer -->\n  <footer class=\"footer\">\n    <div class=\"container\">\n      <div class=\"footer-content\">\n        <div class=\"footer-section\">\n          <h3>La Belle Cuisine</h3>\n          <p>For educational purposes only. Do not deploy in production.</p>\n        </div>\n        <div class=\"footer-section\">\n          <h3>Quick Links</h3>\n          <ul>\n            <li><a href=\"/\">Home</a></li>\n            <li><a href=\"#about\">About</a></li>\n            <li><a href=\"/menu\">Menu</a></li>\n            <li><a href=\"#contact\">Contact</a></li>\n          </ul>\n        </div>\n        <div class=\"footer-section\">\n          <h3>Newsletter</h3>\n          <form class=\"newsletter-form\">\n            <input type=\"email\" placeholder=\"Enter your email\" />\n            <button type=\"submit\" class=\"btn-secondary\">Subscribe</button>\n          </form>\n        </div>\n      </div>\n      <div class=\"footer-bottom\">\n        <p>&copy; 2025 La Belle Cuisine. All rights reserved.</p>\n      </div>\n    </div>\n  </footer>\n\n  <!-- JS -->\n  <script src=\"/js/main.js\"></script>\n</body>\n</html>\n",
    "views/menu.ejs": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Menu - La Belle Cuisine</title>\n\n    <!-- Icons -->\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css\">\n\n    <!-- Your CSS -->\n    <link rel=\"stylesheet\" href=\"/style.css\">\n    <style>\n        .search-container {\n            text-align: center;\n            margin-bottom: 3rem;\n        }\n        .search-form {\n            display: inline-flex;\n            gap: 10px;\n            max-width: 600px;\n            width: 100%;\n        }\n        .search-form input {\n            flex: 1;\n            padding: 10px;\n            border: 1px solid #ddd;\n            border-radius: 5px;\n        }\n        .admin-controls {\n            margin-top: 10px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            border-top: 1px solid #eee;\n            padding-top: 10px;\n        }\n        .btn-sm {\n            padding: 5px 10px;\n            font-size: 0.9rem;\n            border-radius: 3px;\n            text-decoration: none;\n            color: white;\n            display: inline-block;\n        }\n        .btn-edit { background-color: #3498db; }\n        .btn-delete { background-color: #e74c3c; }\n    </style>\n</head>\n\n<body>\n\n    <!-- Navigation -->\n    <nav class=\"navbar\" id=\"navbar\">\n        <div class=\"nav-brand\">\n            <a href=\"/\">La Belle Cuisine</a>\n        </div>\n\n        <div class=\"nav-toggle\" id=\"navToggle\">\n            <i class=\"fas fa-bars\"></i>\n        </div>\n\n        <ul class=\"nav-links\" id=\"navLinks\">\n            <li><a href=\"/\">Home</a></li>\n            <li><a href=\"/#about\">About</a></li>\n            <li><a href=\"/menu\">Menu</a></li>\n            <li><a href=\"/#reservations\">Reservations</a></li>\n            <li><a href=\"/#contact\">Contact</a></li>\n\n            <% if (!user) { %>\n                <li><a href=\"/login\">Login</a></li>\n            <% } else { %>\n                <li><a href=\"/orders\">Orders</a></li>\n                <li><a href=\"/logout\">Logout (<%= user.username %>)</a></li>\n            <% } %>\n        </ul>\n    </nav>\n\n    <!-- Header Section -->\n    <section class=\"hero\" style=\"height: 40vh; min-height: 300px;\">\n        <div class=\"hero-content\">\n            <h1>Our Menu</h1>\n            <p>Discover our exquisite dishes</p>\n            <% if (user && user.role === 'manager') { %>\n                <a href=\"/menu/add\" class=\"btn-primary\">Add New Item</a>\n            <% } %>\n        </div>\n    </section>\n\n    <!-- Menu Section -->\n    <section class=\"menu\">\n        <div class=\"container\">\n            <p class=\"warning\" style=\"text-align: center; color: red; margin-bottom: 20px;\">\u26a0\ufe0f VULNERABLE APPLICATION - FOR SECURITY TESTING ONLY</p>\n\n            <div class=\"search-container\">\n                <form class=\"search-form\" method=\"GET\" action=\"/search\">\n                    <input type=\"text\" name=\"q\" placeholder=\"Search dishes... (SQL Injection allowed)\">\n                    <button type=\"submit\" class=\"btn-primary\">Search</button>\n                </form>\n            </div>\n\n            <div class=\"menu-items\">\n                <% menu.forEach(item => { %>\n                    <div class=\"menu-item\">\n                        <img src=\"/images/menu-placeholder.jpg\" alt=\"<%= item.name %>\" onerror=\"this.onerror=null;this.src='https://via.placeholder.com/300x200?text=Delicious+Food'\">\n                        <div class=\"menu-item-content\">\n                            <h3 class=\"menu-item-title\"><%= item.name %></h3>\n                            <p class=\"menu-item-price\">\u20b9<%= item.price %></p>\n                            \n                            <% if (user) { %>\n                                <div class=\"admin-controls\">\n                                    <a href=\"/orders/add?item_id=<%= item.id %>\" class=\"btn-sm\" style=\"background-color: var(--primary-color);\">Order Now</a>\n                                    <% if (user.role === 'manager') { %>\n                                        <a href=\"/menu/edit/<%= item.id %>\" class=\"btn-sm btn-edit\">Edit</a>\n                                        <a href=\"/menu/delete/<%= item.id %>\" class=\"btn-sm btn-delete\">Delete</a>\n                                    <% } %>\n                                </div>\n                            <% } %>\n                        </div>\n                    </div>\n                <% }) %>\n            </div>\n        </div>\n    </section>\n\n    <!-- Footer -->\n    <footer class=\"footer\">\n        <div class=\"container\">\n            <div class=\"footer-content\">\n                <div class=\"footer-section\">\n                    <h3>La Belle Cuisine</h3>\n                    <p>Experience the art of fine dining in an elegant atmosphere.</p>\n                    <div class=\"social-links\">\n                        <a href=\"#\"><i class=\"fab fa-facebook\"></i></a>\n                        <a href=\"#\"><i class=\"fab fa-instagram\"></i></a>\n                        <a href=\"#\"><i class=\"fab fa-twitter\"></i></a>\n                        <a href=\"#\"><i class=\"fab fa-tripadvisor\"></i></a>\n                    </div>\n                </div>\n                <div class=\"footer-section\">\n                    <h3>Quick Links</h3>\n                    <ul>\n                        <li><a href=\"/\">Home</a></li>\n                        <li><a href=\"/menu\">Menu</a></li>\n                        <li><a href=\"/orders\">Orders</a></li>\n                    </ul>\n                </div>\n                <div class=\"footer-section\">\n                    <h3>Newsletter</h3>\n                    <form class=\"newsletter-form\">\n                        <input type=\"email\" placeholder=\"Enter your email\">\n                        <button type=\"submit\" class=\"btn-secondary\">Subscribe</button>\n                    </form>\n                </div>\n            </div>\n            <div class=\"footer-bottom\">\n                <p>&copy; 2025 La Belle Cuisine. All rights reserved.</p>\n            </div>\n        </div>\n    </footer>\n\n    <!-- JS -->\n    <!-- JS -->\n    <!-- <script src=\"/js/main.js\"></script> -->\n\n</body>\n</html>\n",
    "views/orders.ejs": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Your Orders</title>\n  <!-- <link rel=\"stylesheet\" href=\"/public/style.css\"> -->\n   <link rel=\"stylesheet\" href=\"/css/global.css\">\n<link rel=\"stylesheet\" href=\"/css/orders.css\">\n\n</head>\n<body>\n  <div class=\"container\">\n    <header>\n      <h1>Your Orders</h1>\n      <p class=\"warning\">\u26a0\ufe0f VULNERABLE APPLICATION - FOR SECURITY TESTING ONLY</p>\n\n      <nav>\n        <a href=\"/\">Home</a>\n        <a href=\"/menu\">Menu</a>\n        <a href=\"/orders\">Orders</a>\n        <a href=\"/logout\">Logout (<%= user.username %>)</a>\n      </nav>\n    </header>\n\n    <main>\n      <h2>Place an Order</h2>\n\n      <form method=\"POST\" action=\"/orders/add\">\n        <label>Menu Item ID:</label>\n        <input type=\"text\" name=\"menu_id\" placeholder=\"Enter ID (no auth checks)\">\n\n        <label>Quantity:</label>\n        <input type=\"number\" name=\"qty\">\n\n        <button type=\"submit\">Place Order</button>\n      </form>\n\n      <h2>Your Order History</h2>\n      <table>\n        <tr>\n          <th>ID</th>\n          <th>Item</th>\n          <th>Qty</th>\n          <th>Date</th>\n        </tr>\n\n        <% orders.forEach(o => { %>\n        <tr>\n          <td><%= o.id %></td>\n          <td><%= o.item %></td>\n          <td><%= o.qty %></td>\n          <td><%= o.created_at %></td>\n        </tr>\n        <% }); %>\n      </table>\n    </main>\n\n    <footer>\n      <p>For educational purposes only. Do not deploy.</p>\n    </footer>\n  </div>\n</body>\n</html>\n",
    "views/add_menu.ejs": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Add Menu Item - La Belle Cuisine</title>\n\n    <!-- Icons -->\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css\">\n\n    <!-- Your CSS -->\n    <link rel=\"stylesheet\" href=\"/style.css\">\n</head>\n\n<body>\n\n    <!-- Navigation -->\n    <nav class=\"navbar\" id=\"navbar\">\n        <div class=\"nav-brand\">\n            <a href=\"/\">La Belle Cuisine</a>\n        </div>\n\n        <div class=\"nav-toggle\" id=\"navToggle\">\n            <i class=\"fas fa-bars\"></i>\n        </div>\n\n        <ul class=\"nav-links\" id=\"navLinks\">\n            <li><a href=\"/\">Home</a></li>\n            <li><a href=\"/#about\">About</a></li>\n            <li><a href=\"/menu\">Menu</a></li>\n            <li><a href=\"/#reservations\">Reservations</a></li>\n            <li><a href=\"/#contact\">Contact</a></li>\n\n            <% if (!user) { %>\n                <li><a href=\"/login\">Login</a></li>\n            <% } else { %>\n                <li><a href=\"/orders\">Orders</a></li>\n                <li><a href=\"/logout\">Logout (<%= user.username %>)</a></li>\n            <% } %>\n        </ul>\n    </nav>\n\n    <!-- Header Section -->\n    <section class=\"hero\" style=\"height: 40vh; min-height: 300px;\">\n        <div class=\"hero-content\">\n            <h1>Add Menu Item</h1>\n            <p>Expand our culinary offerings</p>\n        </div>\n    </section>\n\n    <!-- Add Menu Form Section -->\n    <section class=\"reservations\">\n        <div class=\"container\">\n            <h2 class=\"section-title\">New Dish Details</h2>\n            <p class=\"warning\" style=\"text-align: center; color: red; margin-bottom: 20px;\">\u26a0\ufe0f VULNERABLE APPLICATION - FOR SECURITY TESTING ONLY</p>\n\n            <form class=\"reservation-form\" method=\"POST\" action=\"/menu/add\">\n                <div class=\"form-group\">\n                    <label for=\"name\">Dish Name</label>\n                    <input type=\"text\" id=\"name\" name=\"name\" placeholder=\"e.g., Truffle Risotto\" required>\n                </div>\n\n                <div class=\"form-group\">\n                    <label for=\"price\">Price</label>\n                    <input type=\"text\" id=\"price\" name=\"price\" placeholder=\"e.g., 25.00\" required>\n                </div>\n\n                <button type=\"submit\" class=\"btn-primary\" style=\"width: 100%;\">Add Item</button>\n            </form>\n        </div>\n    </section>\n\n    <!-- Footer -->\n    <footer class=\"footer\">\n        <div class=\"container\">\n            <div class=\"footer-content\">\n                <div class=\"footer-section\">\n                    <h3>La Belle Cuisine</h3>\n                    <p>Experience the art of fine dining in an elegant atmosphere.</p>\n                    <div class=\"social-links\">\n                        <a href=\"#\"><i class=\"fab fa-facebook\"></i></a>\n                        <a href=\"#\"><i class=\"fab fa-instagram\"></i></a>\n                        <a href=\"#\"><i class=\"fab fa-twitter\"></i></a>\n                        <a href=\"#\"><i class=\"fab fa-tripadvisor\"></i></a>\n                    </div>\n                </div>\n                <div class=\"footer-section\">\n                    <h3>Quick Links</h3>\n                    <ul>\n                        <li><a href=\"/\">Home</a></li>\n                        <li><a href=\"/menu\">Menu</a></li>\n                        <li><a href=\"/orders\">Orders</a></li>\n                    </ul>\n                </div>\n                <div class=\"footer-section\">\n                    <h3>Newsletter</h3>\n                    <form class=\"newsletter-form\">\n                        <input type=\"email\" placeholder=\"Enter your email\">\n                        <button type=\"submit\" class=\"btn-secondary\">Subscribe</button>\n                    </form>\n                </div>\n            </div>\n            <div class=\"footer-bottom\">\n                <p>&copy; 2025 La Belle Cuisine. All rights reserved.</p>\n            </div>\n        </div>\n    </footer>\n\n    <!-- JS -->\n    <script src=\"/js/main.js\"></script>\n\n</body>\n</html>\n",
    "public/style.css": "/* Global Styles */\n:root {\n    --primary-color: #c17817;\n    --secondary-color: #2c3e50;\n    --text-color: #333;\n    --light-color: #f4f4f4;\n    --dark-color: #222;\n    --transition: all 0.3s ease;\n}\n\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nhtml {\n    scroll-behavior: smooth;\n}\n\nbody {\n    font-family: 'Arial', sans-serif;\n    line-height: 1.6;\n    color: var(--text-color);\n}\n\n.container {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 0 20px;\n}\n\n/* Navigation */\n.navbar {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    background: rgba(255, 255, 255, 0.95);\n    box-shadow: 0 2px 5px rgba(0,0,0,0.1);\n    padding: 1rem 0;\n    z-index: 1000;\n    transition: var(--transition);\n}\n\n.navbar.scrolled {\n    background: white;\n}\n\n.nav-brand {\n    float: left;\n    padding-left: 2rem;\n}\n\n.nav-brand a {\n    color: var(--primary-color);\n    text-decoration: none;\n    font-size: 1.5rem;\n    font-weight: bold;\n}\n\n.nav-toggle {\n    display: none;\n    cursor: pointer;\n    float: right;\n    padding: 0.5rem 1rem;\n}\n\n.nav-links {\n    float: right;\n    padding-right: 2rem;\n    list-style: none;\n}\n\n.nav-links li {\n    display: inline-block;\n    margin-left: 1.5rem;\n}\n\n.nav-links a {\n    color: var(--secondary-color);\n    text-decoration: none;\n    transition: var(--transition);\n}\n\n.nav-links a:hover {\n    color: var(--primary-color);\n}\n\n/* Hero Section */\n.hero {\n    height: 100vh;\n    background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('../images/hero-bg.jpg');\n    background-size: cover;\n    background-position: center;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    text-align: center;\n    color: white;\n}\n\n.hero-content {\n    max-width: 800px;\n    padding: 2rem;\n}\n\n.hero-content h1 {\n    font-size: 3.5rem;\n    margin-bottom: 1rem;\n}\n\n.hero-content p {\n    font-size: 1.5rem;\n    margin-bottom: 2rem;\n}\n\n/* Buttons */\n.btn-primary {\n    display: inline-block;\n    padding: 1rem 2rem;\n    background: var(--primary-color);\n    color: white;\n    text-decoration: none;\n    border-radius: 5px;\n    transition: var(--transition);\n}\n\n.btn-primary:hover {\n    background: darken(var(--primary-color), 10%);\n    transform: translateY(-2px);\n}\n\n.btn-secondary {\n    display: inline-block;\n    padding: 0.8rem 1.5rem;\n    background: var(--secondary-color);\n    color: white;\n    text-decoration: none;\n    border-radius: 5px;\n    transition: var(--transition);\n}\n\n/* About Section */\n.about {\n    padding: 5rem 0;\n    background: var(--light-color);\n}\n\n.section-title {\n    text-align: center;\n    font-size: 2.5rem;\n    margin-bottom: 3rem;\n    color: var(--secondary-color);\n}\n\n.about-content {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 4rem;\n    align-items: center;\n}\n\n.about-text p {\n    margin-bottom: 1.5rem;\n}\n\n.about-image img {\n    width: 100%;\n    border-radius: 10px;\n    box-shadow: 0 5px 15px rgba(0,0,0,0.1);\n}\n\n/* Menu Section */\n.menu {\n    padding: 5rem 0;\n}\n\n.menu-categories {\n    display: flex;\n    justify-content: center;\n    margin-bottom: 2rem;\n    flex-wrap: wrap;\n}\n\n.menu-category {\n    padding: 0.8rem 1.5rem;\n    margin: 0.5rem;\n    border: none;\n    background: var(--light-color);\n    cursor: pointer;\n    transition: var(--transition);\n}\n\n.menu-category.active,\n.menu-category:hover {\n    background: var(--primary-color);\n    color: white;\n}\n\n.menu-items {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 2rem;\n    padding: 2rem 0;\n}\n\n.menu-item {\n    background: white;\n    border-radius: 10px;\n    overflow: hidden;\n    box-shadow: 0 3px 10px rgba(0,0,0,0.1);\n    transition: var(--transition);\n}\n\n.menu-item:hover {\n    transform: translateY(-5px);\n}\n\n.menu-item img {\n    width: 100%;\n    height: 200px;\n    object-fit: cover;\n}\n\n.menu-item-content {\n    padding: 1.5rem;\n}\n\n.menu-item-title {\n    font-size: 1.2rem;\n    margin-bottom: 0.5rem;\n}\n\n.menu-item-price {\n    color: var(--primary-color);\n    font-weight: bold;\n    font-size: 1.1rem;\n}\n\n/* Reservations Section */\n.reservations {\n    padding: 5rem 0;\n    background: var(--light-color);\n}\n\n.reservation-form {\n    max-width: 600px;\n    margin: 0 auto;\n    background: white;\n    padding: 2rem;\n    border-radius: 10px;\n    box-shadow: 0 5px 15px rgba(0,0,0,0.1);\n}\n\n.form-group {\n    margin-bottom: 1.5rem;\n}\n\n.form-row {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 1rem;\n}\n\n.form-group input,\n.form-group select,\n.form-group textarea {\n    width: 100%;\n    padding: 0.8rem;\n    border: 1px solid #ddd;\n    border-radius: 5px;\n    font-size: 1rem;\n}\n\n.form-group textarea {\n    height: 100px;\n    resize: vertical;\n}\n\n/* Contact Section */\n.contact {\n    padding: 5rem 0;\n}\n\n.contact-content {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 4rem;\n}\n\n.contact-info {\n    display: grid;\n    gap: 2rem;\n}\n\n.contact-item {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n}\n\n.contact-item i {\n    font-size: 1.5rem;\n    color: var(--primary-color);\n}\n\n.contact-map {\n    border-radius: 10px;\n    overflow: hidden;\n}\n\n/* Footer */\n.footer {\n    background: var(--dark-color);\n    color: white;\n    padding: 4rem 0 0;\n}\n\n.footer-content {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n    gap: 2rem;\n    margin-bottom: 2rem;\n}\n\n.footer-section h3 {\n    margin-bottom: 1rem;\n    color: var(--primary-color);\n}\n\n.social-links {\n    margin-top: 1rem;\n}\n\n.social-links a {\n    color: white;\n    margin-right: 1rem;\n    font-size: 1.5rem;\n    transition: var(--transition);\n}\n\n.social-links a:hover {\n    color: var(--primary-color);\n}\n\n.footer-section ul {\n    list-style: none;\n}\n\n.footer-section ul li {\n    margin-bottom: 0.5rem;\n}\n\n.footer-section ul a {\n    color: white;\n    text-decoration: none;\n    transition: var(--transition);\n}\n\n.footer-section ul a:hover {\n    color: var(--primary-color);\n}\n\n.newsletter-form input {\n    padding: 0.8rem;\n    border: none;\n    border-radius: 5px;\n    margin-right: 0.5rem;\n}\n\n.footer-bottom {\n    text-align: center;\n    padding: 1.5rem 0;\n    border-top: 1px solid rgba(255,255,255,0.1);\n}\n\n/* Modal */\n.modal {\n    display: none;\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0,0,0,0.5);\n    z-index: 1100;\n}\n\n.modal-content {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    background: white;\n    padding: 2rem;\n    border-radius: 10px;\n    width: 90%;\n    max-width: 500px;\n}\n\n.close {\n    position: absolute;\n    top: 1rem;\n    right: 1rem;\n    font-size: 1.5rem;\n    cursor: pointer;\n}\n\n/* Responsive Design */\n@media (max-width: 768px) {\n    .nav-toggle {\n        display: block;\n    }\n\n    .nav-links {\n        display: none;\n        width: 100%;\n        position: absolute;\n        top: 100%;\n        left: 0;\n        background: white;\n        padding: 1rem 0;\n        text-align: center;\n    }\n\n    .nav-links.active {\n        display: block;\n    }\n\n    .nav-links li {\n        display: block;\n        margin: 1rem 0;\n    }\n\n    .hero-content h1 {\n        font-size: 2.5rem;\n    }\n\n    .about-content,\n    .contact-content {\n        grid-template-columns: 1fr;\n    }\n\n    .menu-categories {\n        flex-direction: column;\n        align-items: center;\n    }\n\n    .menu-category {\n        width: 80%;\n        text-align: center;\n    }\n}",
    "README-VULNERABILITIES.md": "# Intentionally Vulnerable Restaurant Website\n\nThis website has been intentionally built with multiple vulnerabilities for research and educational purposes. **DO NOT USE IN PRODUCTION.**\n\n## Vulnerabilities Implemented\n\n### 1. SQL Injection Vulnerabilities\n- **Location**: All API endpoints in `src/server.js`\n- **Issue**: Direct string interpolation in SQL queries without parameterization\n- **Example**: `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`\n- **Impact**: Attackers can execute arbitrary SQL queries, potentially accessing or modifying data\n\n### 2. Cross-Site Scripting (XSS)\n- **Location**: User input display throughout the application\n- **Issue**: No output encoding or sanitization\n- **Impact**: Malicious scripts can be injected and executed in users' browsers\n\n### 3. Authentication Bypass\n- **Location**: Cookie-based authentication in server.js\n- **Issue**: User credentials stored in cookies without proper security (httpOnly: false)\n- **Impact**: User data accessible via JavaScript, vulnerable to XSS theft\n\n### 4. No Input Validation\n- **Location**: All input fields in forms\n- **Issue**: No client or server-side validation\n- **Impact**: Invalid or malicious data can be submitted and processed\n\n### 5. Exposed Error Messages\n- **Location**: All database query error handlers\n- **Issue**: Internal error messages exposed to users\n- **Impact**: Reveals database structure and implementation details\n\n### 6. Plaintext Password Storage\n- **Location**: database-setup.sql\n- **Issue**: Passwords stored in plaintext\n- **Impact**: If database is compromised, all passwords are exposed\n\n### 7. Missing Access Controls\n- **Location**: Menu management endpoints\n- **Issue**: Insufficient authorization checks\n- **Impact**: Unauthorized users may access or modify data\n\n## How to Set Up\n\n### Prerequisites\n- Node.js installed\n- Aurora MySQL database instance\n\n### Setup Steps\n\n1. **Install Dependencies**\n   ```bash\n   npm install\n   ```\n\n2. **Configure Aurora DB Connection**\n   - Update `src/server.js` with your Aurora endpoint\n   - Or set environment variables:\n     ```bash\n     export DB_HOST=your-aurora-cluster.cluster-xxxxx.region.rds.amazonaws.com\n     export DB_USER=admin\n     export DB_PASSWORD=your-password\n     export DB_NAME=restaurant_db\n     ```\n\n3. **Setup Database**\n   - Connect to your Aurora MySQL instance\n   - Run `database-setup.sql` to create tables and sample data:\n     ```bash\n     mysql -h your-aurora-endpoint -u admin -p < database-setup.sql\n     ```\n\n4. **Start the Server**\n   ```bash\n   npm start\n   ```\n\n5. **Access the Application**\n   - Homepage: http://localhost:3000\n   - Register page: http://localhost:3000/register\n\n## Testing Vulnerabilities\n\n### SQL Injection Testing\nTry these payloads in the login form:\n```\nUsername: admin' OR '1'='1\nPassword: anything\n```\n\n### XSS Testing\nTry this in any text input field:\n```html\n<script>alert('XSS')</script>\n```\n\n### Registration Testing\nAccess the register page manually by typing:\n```\nhttp://localhost:3000/register\n```\n\n## Security Notes\n\n\u26a0\ufe0f **WARNING**: This application is intentionally vulnerable and should:\n- NEVER be deployed to production\n- ONLY be used in isolated environments\n- ONLY be used for educational purposes\n- Be protected by proper network security\n\n## Legal Notice\n\nThis software is provided for educational and research purposes only. Users are responsible for ensuring compliance with all applicable laws and regulations regarding security testing and vulnerability disclosure.\n\n",
    "package.json": "{\n  \"name\": \"vulnerable-restaurant-app\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Deliberately vulnerable web application for security testing\",\n  \"main\": \"server.js\",\n  \"scripts\": {\n    \"start\": \"node server.js\",\n    \"dev\": \"nodemon server.js\"\n  },\n  \"keywords\": [\"security\", \"testing\", \"vulnerable\", \"education\"],\n  \"author\": \"\",\n  \"license\": \"MIT\",\n  \"dependencies\": {\n    \"express\": \"^4.18.2\",\n    \"express-session\": \"^1.17.3\",\n    \"mysql2\": \"^3.6.0\",\n    \"body-parser\": \"^1.20.2\",\n    \"ejs\": \"^3.1.9\"\n  },\n  \"devDependencies\": {\n    \"nodemon\": \"^3.0.1\"\n  }\n}",
    "setup.sql": "-- Database Setup for Vulnerable Restaurant Application\n-- For Aurora MySQL or standard MySQL\n\nCREATE DATABASE IF NOT EXISTS restaurant_db;\nUSE restaurant_db;\n\n-- Users table\nCREATE TABLE IF NOT EXISTS users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(50) NOT NULL UNIQUE,\n  password VARCHAR(255) NOT NULL,\n  role ENUM('manager', 'employee') NOT NULL DEFAULT 'employee',\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Menu items table\nCREATE TABLE IF NOT EXISTS menu_items (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(100) NOT NULL,\n  description TEXT,\n  price DECIMAL(5,2) NOT NULL,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Orders table\nCREATE TABLE IF NOT EXISTS orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  user_id INT NOT NULL,\n  item_id INT NOT NULL,\n  quantity INT NOT NULL DEFAULT 1,\n  order_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n  FOREIGN KEY (item_id) REFERENCES menu_items(id) ON DELETE CASCADE\n);\n\n-- Insert sample users (passwords stored in plain text - VULNERABILITY)\nINSERT INTO users (username, password, role) VALUES\n('admin', 'admin123', 'manager'),\n('manager1', 'manager', 'manager'),\n('employee1', 'employee123', 'employee'),\n('employee2', 'pass123', 'employee'),\n('testuser', 'test', 'employee');\n\n-- Insert sample menu items\nINSERT INTO menu_items (name, description, price) VALUES\n('Margherita Pizza', 'Classic tomato and mozzarella pizza', 12.99),\n('Caesar Salad', 'Fresh romaine lettuce with Caesar dressing', 8.99),\n('Spaghetti Carbonara', 'Pasta with bacon, eggs, and parmesan', 14.99),\n('Grilled Chicken Breast', 'Seasoned chicken with vegetables', 16.99),\n('Chocolate Lava Cake', 'Warm chocolate cake with molten center', 6.99),\n('Garlic Bread', 'Toasted bread with garlic butter', 4.99),\n('Mushroom Risotto', 'Creamy Italian rice with mushrooms', 13.99),\n('Fish and Chips', 'Battered cod with french fries', 15.99);\n\n-- Insert sample orders\nINSERT INTO orders (user_id, item_id, quantity) VALUES\n(3, 1, 2),\n(3, 5, 1),\n(4, 2, 1),\n(4, 3, 1),\n(5, 1, 1),\n(5, 4, 1);\n\n-- Create indexes for better performance\nCREATE INDEX idx_orders_user ON orders(user_id);\nCREATE INDEX idx_orders_item ON orders(item_id);\n\n-- Display table information\nSELECT 'Users Table' as Info;\nSELECT * FROM users;\n\nSELECT 'Menu Items Table' as Info;\nSELECT * FROM menu_items;\n\nSELECT 'Orders Table' as Info;\nSELECT * FROM orders;"
  },
  "vulnerabilities_documentation": "# Intentionally Vulnerable Restaurant Website\n\nThis website has been intentionally built with multiple vulnerabilities for research and educational purposes. **DO NOT USE IN PRODUCTION.**\n\n## Vulnerabilities Implemented\n\n### 1. SQL Injection Vulnerabilities\n- **Location**: All API endpoints in `src/server.js`\n- **Issue**: Direct string interpolation in SQL queries without parameterization\n- **Example**: `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`\n- **Impact**: Attackers can execute arbitrary SQL queries, potentially accessing or modifying data\n\n### 2. Cross-Site Scripting (XSS)\n- **Location**: User input display throughout the application\n- **Issue**: No output encoding or sanitization\n- **Impact**: Malicious scripts can be injected and executed in users' browsers\n\n### 3. Authentication Bypass\n- **Location**: Cookie-based authentication in server.js\n- **Issue**: User credentials stored in cookies without proper security (httpOnly: false)\n- **Impact**: User data accessible via JavaScript, vulnerable to XSS theft\n\n### 4. No Input Validation\n- **Location**: All input fields in forms\n- **Issue**: No client or server-side validation\n- **Impact**: Invalid or malicious data can be submitted and processed\n\n### 5. Exposed Error Messages\n- **Location**: All database query error handlers\n- **Issue**: Internal error messages exposed to users\n- **Impact**: Reveals database structure and implementation details\n\n### 6. Plaintext Password Storage\n- **Location**: database-setup.sql\n- **Issue**: Passwords stored in plaintext\n- **Impact**: If database is compromised, all passwords are exposed\n\n### 7. Missing Access Controls\n- **Location**: Menu management endpoints\n- **Issue**: Insufficient authorization checks\n- **Impact**: Unauthorized users may access or modify data\n\n## How to Set Up\n\n### Prerequisites\n- Node.js installed\n- Aurora MySQL database instance\n\n### Setup Steps\n\n1. **Install Dependencies**\n   ```bash\n   npm install\n   ```\n\n2. **Configure Aurora DB Connection**\n   - Update `src/server.js` with your Aurora endpoint\n   - Or set environment variables:\n     ```bash\n     export DB_HOST=your-aurora-cluster.cluster-xxxxx.region.rds.amazonaws.com\n     export DB_USER=admin\n     export DB_PASSWORD=your-password\n     export DB_NAME=restaurant_db\n     ```\n\n3. **Setup Database**\n   - Connect to your Aurora MySQL instance\n   - Run `database-setup.sql` to create tables and sample data:\n     ```bash\n     mysql -h your-aurora-endpoint -u admin -p < database-setup.sql\n     ```\n\n4. **Start the Server**\n   ```bash\n   npm start\n   ```\n\n5. **Access the Application**\n   - Homepage: http://localhost:3000\n   - Register page: http://localhost:3000/register\n\n## Testing Vulnerabilities\n\n### SQL Injection Testing\nTry these payloads in the login form:\n```\nUsername: admin' OR '1'='1\nPassword: anything\n```\n\n### XSS Testing\nTry this in any text input field:\n```html\n<script>alert('XSS')</script>\n```\n\n### Registration Testing\nAccess the register page manually by typing:\n```\nhttp://localhost:3000/register\n```\n\n## Security Notes\n\n\u26a0\ufe0f **WARNING**: This application is intentionally vulnerable and should:\n- NEVER be deployed to production\n- ONLY be used in isolated environments\n- ONLY be used for educational purposes\n- Be protected by proper network security\n\n## Legal Notice\n\nThis software is provided for educational and research purposes only. Users are responsible for ensuring compliance with all applicable laws and regulations regarding security testing and vulnerability disclosure.\n\n"
}